legend.box.margin = margin(l = 10, unit = "pt")
)
# Create county-level access map
library(ggplot2)
library(viridis)
county_map_data <- pa_counties_proj %>%
left_join(county_summary, by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot() +
# Counties filled by % underserved vulnerable tracts
geom_sf(data = county_map_data, aes(fill = pct_underserved_vulnerable),
color = "white", size = 0.3) +
# Hospital locations as points
geom_sf(data = hospitals_proj, aes(color = "Hospitals"),
size = 1, alpha = 0.7, show.legend = "point") +
# Color scale for access challenge
scale_fill_viridis(
name = "Percent Underserved",
option = "C",
direction = -1,
labels = function(x) paste0(x, "%")
) +
# Hospital point color scale
scale_color_manual(
name = "",
values = c("Hospitals" = "red2")
) +
# Map titles and caption
labs(
title = "URDERSERVED COUNTIES AND HOSPITAL LOCATION",
subtitle = "Pennsylvania, US",
caption = "Source: American Community Survey (2022), Pennsylvania Hospital Data, U.S. Census TIGER/Line Shapefiles"
) +
# Clean minimal theme with custom styling
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt")
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt")
),
legend.title = element_text(
size = 11,
face = "bold"
),
legend.text = element_text(
size = 10,
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt")
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
# Create county-level access map
library(ggplot2)
library(viridis)
county_map_data <- pa_counties_proj %>%
left_join(county_summary, by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot() +
# Counties filled by % underserved vulnerable tracts
geom_sf(data = county_map_data, aes(fill = pct_underserved_vulnerable),
color = "white", size = 0.3) +
# Hospital locations as points
geom_sf(data = hospitals_proj, aes(color = "Hospitals"),
size = 1, alpha = 0.7, show.legend = "point") +
# Color scale for access challenge
scale_fill_viridis(
name = "Percent Underserved",
option = "C",
direction = -1,
labels = function(x) paste0(x, "%")
) +
# Hospital point color scale
scale_color_manual(
name = "",
values = c("Hospitals" = "red2")
) +
# Map titles and caption
labs(
title = "URDERSERVED COUNTIES AND HOSPITAL LOCATION",
subtitle = "Pennsylvania, US",
caption = "Source: American Community Survey (2022), Pennsylvania Hospital Data"
) +
# Clean minimal theme with custom styling
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt")
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt")
),
legend.title = element_text(
size = 11,
face = "bold"
),
legend.text = element_text(
size = 10,
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt")
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
# Create detailed tract-level map
ggplot() +
# 1. 所有普查区背景（灰色）——表示非弱势区域
geom_sf(data = pa_tracts_proj, aes(fill = "Non-vulnerable"),
color = NA, show.legend = "polygon") +
# 2. 弱势但不服务不足的区域（浅黄色）
geom_sf(data = filter(pa_tracts_proj, vulnerable == TRUE & underserved == FALSE),
aes(fill = "Vulnerable but Served"),
color = NA, show.legend = "polygon") +
# 3. 服务不足的弱势区域（亮红色，最突出）
geom_sf(data = filter(pa_tracts_proj, underserved == TRUE & vulnerable == TRUE),
aes(fill = "Underserved Vulnerable"),
color = "white", size = 0.05, show.legend = "polygon") +
# 4. 县界线（白色）
geom_sf(data = pa_counties_proj, fill = NA, color = "white", size = 0.3) +
# 5. 医院位置（蓝色点）
geom_sf(data = hospitals_proj, aes(color = "Hospitals"),
size = 0.8, alpha = 0.7, show.legend = "point") +
# 6. 填充颜色图例
scale_fill_manual(
name = "Tract Categories",
values = c(
"Non-vulnerable" = "grey90",
"Vulnerable but Served" = "#FED976",
"Underserved Vulnerable" = "#E31A1C"
),
breaks = c("Underserved Vulnerable", "Vulnerable but Served", "Non-vulnerable")
) +
# 7. 医院点图例
scale_color_manual(
name = "",
values = c("Hospitals" = "blue")
) +
# 8. 添加标题、说明与数据来源
labs(
title = "UNDERSERVED VULNERABLE TRACTS IN PENNSYLVANIA",
subtitle = "Red areas represent vulnerable tracts located more than 15 miles from the nearest hospital",
caption = "Source: American Community Survey (2022), Pennsylvania Hospital Data, U.S. Census TIGER/Line Shapefiles"
) +
# 9. 设置样式
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt"),
family = "Calibri"
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt"),
family = "Calibri"
),
legend.title = element_text(
size = 11,
face = "bold",
family = "Calibri"
),
legend.text = element_text(
size = 10,
family = "Calibri"
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt"),
family = "Calibri"
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
# Create detailed tract-level map
ggplot() +
# 1. 所有普查区背景（灰色）——表示非弱势区域
geom_sf(data = pa_tracts_proj, fill = "grey90", color = NA) +
# 2. 弱势但不服务不足的区域（浅黄色）
geom_sf(data = filter(pa_tracts_proj, vulnerable == TRUE & underserved == FALSE),
fill = "#FED976", color = NA) +
# 3. 服务不足的弱势区域（亮红色，最突出）
geom_sf(data = filter(pa_tracts_proj, underserved == TRUE & vulnerable == TRUE),
fill = "#E31A1C", color = "white", size = 0.05) +
# 4. 县界线（白色）
geom_sf(data = pa_counties_proj, fill = NA, color = "white", size = 0.3) +
# 5. 医院位置（蓝色点）
geom_sf(data = hospitals_proj, color = "blue", size = 0.8, alpha = 0.7) +
# 6. 添加标题、说明与数据来源
labs(
title = "Underserved Vulnerable Tracts in Pennsylvania",
subtitle = "Red areas represent vulnerable tracts located more than 15 miles from the nearest hospital",
caption = "Data sources: ACS (2022), Pennsylvania Hospital Data, U.S. Census TIGER/Line Shapefiles"
) +
# 7. 设置样式
theme_void() +
theme(
plot.title = element_text(size = 18, face = "bold"),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 9, color = "grey50")
)
# Plot map of percent underserved by Pennsylvania counties.
county_map <- pa_counties_proj %>%
left_join(county_summary %>% select(COUNTY_NAM, pct_underserved_vulnerable),
by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot() +
# Counties filled by % underserved vulnerable tracts
geom_sf(data = county_map, aes(fill = pct_underserved_vulnerable),
color = "white", size = 0.3) +
# Color scale for underserved percentage
scale_fill_viridis_c(
name = "Percent Underserved",
option = "C",  # 使用与第一个地图相同的配色方案
direction = -1,
labels = function(x) paste0(x, "%")
) +
# Map titles and caption
labs(
title = "PERCENT UNDERSERVED BY PENNSYLVANIA COUNTIES",
subtitle = "Pennsylvania, US",
caption = "Source: American Community Survey (2022)"
) +
# Clean minimal theme with custom styling
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt")
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt")
),
legend.title = element_text(
size = 11,
face = "bold"
),
legend.text = element_text(
size = 10,
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt")
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
# Plot map of percent underserved by Pennsylvania counties.
county_map <- pa_counties_proj %>%
left_join(county_summary %>% select(COUNTY_NAM, pct_underserved_vulnerable),
by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot(county_map) +
geom_sf(aes(fill = pct_underserved_vulnerable), color = "white", size = 0.5) +
scale_fill_viridis_c(
name = "Percent Underserved",
option = "magma",
# Format to show percent sign on color bar.
labels = function(x) paste0(x, "%")
) +
labs(
title = "Most Underserved Counties",
subtitle = "Pennsylvania, United States",
caption = "Source: ACS 2018–2022"
) +
theme_void()
# Plot map of percent underserved by Pennsylvania counties.
county_map <- pa_counties_proj %>%
left_join(county_summary %>% select(COUNTY_NAM, pct_underserved_vulnerable),
by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot() +
# Counties filled by % underserved vulnerable tracts
geom_sf(data = county_map, aes(fill = pct_underserved_vulnerable),
color = "white", size = 0.3) +
# Color scale for underserved percentage
scale_fill_viridis_c(
name = "Percent Underserved",
option = "C",  # 使用与第一个地图相同的配色方案
direction = -1,
labels = function(x) paste0(x, "%")
) +
# Map titles and caption
labs(
title = "PERCENT UNDERSERVED BY PENNSYLVANIA COUNTIES",
subtitle = "Pennsylvania, US",
caption = "Source: American Community Survey (2022)"
) +
# Clean minimal theme with custom styling
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt")
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt")
),
legend.title = element_text(
size = 11,
face = "bold"
),
legend.text = element_text(
size = 10,
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt")
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
# Plot map of percent underserved by Pennsylvania counties.
county_map <- pa_counties_proj %>%
left_join(county_summary %>% select(COUNTY_NAM, pct_underserved_vulnerable),
by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot() +
# Counties filled by % underserved vulnerable tracts
geom_sf(data = county_map, aes(fill = pct_underserved_vulnerable),
color = "white", size = 0.3) +
# Color scale for underserved percentage
scale_fill_viridis_c(
name = "Percent Underserved",
option = "plasma",
direction = -1,
labels = function(x) paste0(x, "%")
) +
# Map titles and caption
labs(
title = "PERCENT UNDERSERVED BY PENNSYLVANIA COUNTIES",
subtitle = "Pennsylvania, US",
caption = "Source: American Community Survey (2022)"
) +
# Clean minimal theme with custom styling
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt")
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt")
),
legend.title = element_text(
size = 11,
face = "bold"
),
legend.text = element_text(
size = 10,
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt")
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
# Plot map of percent underserved by Pennsylvania counties.
county_map <- pa_counties_proj %>%
left_join(county_summary %>% select(COUNTY_NAM, pct_underserved_vulnerable),
by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot() +
# Counties filled by % underserved vulnerable tracts
geom_sf(data = county_map, aes(fill = pct_underserved_vulnerable),
color = "white", size = 0.3) +
# Color scale for underserved percentage
scale_fill_viridis_c(
name = "Percent Underserved",
option = "inferno",
direction = -1,
labels = function(x) paste0(x, "%")
) +
# Map titles and caption
labs(
title = "PERCENT UNDERSERVED BY PENNSYLVANIA COUNTIES",
subtitle = "Pennsylvania, US",
caption = "Source: American Community Survey (2022)"
) +
# Clean minimal theme with custom styling
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt")
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt")
),
legend.title = element_text(
size = 11,
face = "bold"
),
legend.text = element_text(
size = 10,
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt")
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
# Plot map of percent underserved by Pennsylvania counties.
county_map <- pa_counties_proj %>%
left_join(county_summary %>% select(COUNTY_NAM, pct_underserved_vulnerable),
by = c("COUNTY_NAM" = "COUNTY_NAM"))
ggplot() +
# Counties filled by % underserved vulnerable tracts
geom_sf(data = county_map, aes(fill = pct_underserved_vulnerable),
color = "white", size = 0.3) +
# Color scale for underserved percentage
scale_fill_viridis_c(
name = "Percent Underserved",
option = "viridis",
direction = -1,
labels = function(x) paste0(x, "%")
) +
# Map titles and caption
labs(
title = "PERCENT UNDERSERVED BY PENNSYLVANIA COUNTIES",
subtitle = "Pennsylvania, US",
caption = "Source: American Community Survey (2022)"
) +
# Clean minimal theme with custom styling
theme_void() +
theme(
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
plot.title = element_text(
size = 14,
face = "bold",
hjust = 0.5,
margin = margin(b = 5, unit = "pt")
),
plot.subtitle = element_text(
size = 10,
hjust = 0.5,
margin = margin(b = 15, t = 5, unit = "pt")
),
legend.title = element_text(
size = 11,
face = "bold"
),
legend.text = element_text(
size = 10,
),
plot.caption = element_text(
size = 9,
color = "gray40",
face = "italic",
margin = margin(t = 10, unit = "pt")
),
legend.position = "right",
legend.box.margin = margin(l = 10, unit = "pt")
)
